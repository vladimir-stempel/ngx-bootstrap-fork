{"version":3,"file":"format-years-calendar.js","sourceRoot":"","sources":["../../../../../src/datepicker/engine/format-years-calendar.ts"],"names":[],"mappings":"AAKA,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,MAAM,uBAAuB,CAAC;AAC9D,OAAO,EAAE,YAAY,EAAE,MAAM,uBAAuB,CAAC;AAErD,MAAM,MAAM,GAAG,CAAC,CAAC;AACjB,MAAM,KAAK,GAAG,CAAC,CAAC;AAChB,MAAM,CAAC,MAAM,gBAAgB,GAAG,MAAM,GAAG,KAAK,CAAC;AAC/C,MAAM,CAAC,MAAM,gBAAgB,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;AAC5E,MAAM,KAAK,GAAG,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC;AAE1B,MAAM,UAAU,mBAAmB,CACjC,QAAc,EACd,aAAsC,EACtC,mBAA0B;IAE1B,MAAM,WAAW,GAAG,oBAAoB,CAAC,QAAQ,EAAE,mBAAmB,CAAC,CAAC;IACxE,MAAM,aAAa,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC;IAC5D,MAAM,WAAW,GAAG,YAAY,CAE9B,aAAa,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;QACxB,IAAI;QACJ,KAAK,EAAE,UAAU,CAAC,IAAI,EAAE,aAAa,CAAC,SAAS,EAAE,aAAa,CAAC,MAAM,CAAC;KACvE,CAAC,CAAC,CAAC;IACJ,MAAM,SAAS,GAAG,oBAAoB,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;IAEnE,OAAO;QACL,KAAK,EAAE,WAAW;QAClB,UAAU,EAAE,EAAE;QACd,SAAS;KACV,CAAC;AACJ,CAAC;AAED,SAAS,oBAAoB,CAAC,QAAc,EAAE,mBAA0B;IACtE,IAAI,mBAAmB;WAClB,QAAQ,CAAC,WAAW,EAAE,IAAI,mBAAmB,CAAC,WAAW,EAAE;WAC3D,QAAQ,CAAC,WAAW,EAAE,GAAG,mBAAmB,CAAC,WAAW,EAAE,GAAG,gBAAgB,EAAE;QAClF,OAAO,mBAAmB,CAAC;KAC5B;IAED,OAAO,SAAS,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,gBAAgB,EAAE,CAAC,CAAC;AACzD,CAAC;AAED,SAAS,oBAAoB,CAC3B,WAAsC,EACtC,aAAsC;IAEtC,MAAM,IAAI,GAAG,UAAU,CACrB,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EACtB,aAAa,CAAC,SAAS,EACvB,aAAa,CAAC,MAAM,CACrB,CAAC;IACF,MAAM,EAAE,GAAG,UAAU,CACnB,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,IAAI,EACvC,aAAa,CAAC,SAAS,EACvB,aAAa,CAAC,MAAM,CACrB,CAAC;IAEF,OAAO,GAAG,IAAI,MAAM,EAAE,EAAE,CAAC;AAC3B,CAAC","sourcesContent":["import {\r\n  DatepickerFormatOptions,\r\n  YearsCalendarViewModel,\r\n  CalendarCellViewModel\r\n} from '../models';\r\nimport { shiftDate, formatDate } from 'ngx-bootstrap/chronos';\r\nimport { createMatrix } from '../utils/matrix-utils';\r\n\r\nconst height = 4;\r\nconst width = 4;\r\nexport const yearsPerCalendar = height * width;\r\nexport const initialYearShift = (Math.floor(yearsPerCalendar / 2) - 1) * -1;\r\nconst shift = { year: 1 };\r\n\r\nexport function formatYearsCalendar(\r\n  viewDate: Date,\r\n  formatOptions: DatepickerFormatOptions,\r\n  previousInitialDate?: Date\r\n): YearsCalendarViewModel {\r\n  const initialDate = calculateInitialDate(viewDate, previousInitialDate);\r\n  const matrixOptions = { width, height, initialDate, shift };\r\n  const yearsMatrix = createMatrix<\r\n    CalendarCellViewModel\r\n  >(matrixOptions, date => ({\r\n    date,\r\n    label: formatDate(date, formatOptions.yearLabel, formatOptions.locale)\r\n  }));\r\n  const yearTitle = formatYearRangeTitle(yearsMatrix, formatOptions);\r\n\r\n  return {\r\n    years: yearsMatrix,\r\n    monthTitle: '',\r\n    yearTitle\r\n  };\r\n}\r\n\r\nfunction calculateInitialDate(viewDate: Date, previousInitialDate?: Date): Date {\r\n  if (previousInitialDate\r\n    && viewDate.getFullYear() >= previousInitialDate.getFullYear()\r\n    && viewDate.getFullYear() < previousInitialDate.getFullYear() + yearsPerCalendar) {\r\n    return previousInitialDate;\r\n  }\r\n\r\n  return shiftDate(viewDate, { year: initialYearShift });\r\n}\r\n\r\nfunction formatYearRangeTitle(\r\n  yearsMatrix: CalendarCellViewModel[][],\r\n  formatOptions: DatepickerFormatOptions\r\n): string {\r\n  const from = formatDate(\r\n    yearsMatrix[0][0].date,\r\n    formatOptions.yearTitle,\r\n    formatOptions.locale\r\n  );\r\n  const to = formatDate(\r\n    yearsMatrix[height - 1][width - 1].date,\r\n    formatOptions.yearTitle,\r\n    formatOptions.locale\r\n  );\r\n\r\n  return `${from} - ${to}`;\r\n}\r\n"]}