{"version":3,"file":"flag-years-calendar.js","sourceRoot":"","sources":["../../../../../src/datepicker/engine/flag-years-calendar.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,uBAAuB,CAAC;AAE9D,OAAO,EAAE,cAAc,EAAE,MAAM,4BAA4B,CAAC;AAa5D,MAAM,UAAU,iBAAiB,CAC/B,aAAqC,EACrC,OAAiC;IAEjC,aAAa,CAAC,KAAK,CAAC,OAAO,CACzB,CAAC,KAA8B,EAAE,QAAgB,EAAE,EAAE;QACnD,KAAK,CAAC,OAAO,CAAC,CAAC,IAA2B,EAAE,SAAiB,EAAE,EAAE;YAC/D,IAAI,UAAmB,CAAC;YACxB,MAAM,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,WAAW,CAAC,CAAC;YAC7D,MAAM,UAAU,GACd,OAAO,CAAC,UAAU;gBAClB,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;YAE9D,IAAI,CAAC,OAAO,CAAC,YAAY,IAAI,OAAO,CAAC,aAAa,EAAE;gBAClD,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC7D,IAAI,CAAC,UAAU,EAAE;oBACf,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC9D;aACF;iBAAM;gBACL,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,YAAY,CAAC,CAAC;aAC1D;YAED,MAAM,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC;YACpF,IACE,IAAI,CAAC,SAAS,KAAK,QAAQ,CAAC,SAAS;gBACrC,IAAI,CAAC,UAAU,KAAK,QAAQ,CAAC,UAAU;gBACvC,IAAI,CAAC,UAAU,KAAK,QAAQ,CAAC,UAAU,EACvC;gBACA,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,GAAG,QAAQ,CAAC;aACrD;QACH,CAAC,CAAC,CAAC;IACL,CAAC,CACF,CAAC;IAEF,uCAAuC;IACvC,aAAa,CAAC,aAAa;QACzB,OAAO,CAAC,SAAS,GAAG,CAAC,IAAI,OAAO,CAAC,SAAS,KAAK,OAAO,CAAC,aAAa,CAAC;IACvE,aAAa,CAAC,cAAc;QAC1B,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC,aAAa;YACzC,OAAO,CAAC,SAAS,GAAG,CAAC,KAAK,OAAO,CAAC,aAAa,CAAC;IAElD,aAAa,CAAC,gBAAgB,GAAG,cAAc,CAC7C,SAAS,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EACvD,OAAO,CAAC,OAAO,EACf,OAAO,CAAC,OAAO,CAChB,CAAC;IACF,MAAM,CAAC,GAAG,aAAa,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;IACzC,MAAM,CAAC,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;IAC5C,aAAa,CAAC,iBAAiB,GAAG,cAAc,CAC9C,SAAS,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,EACtD,OAAO,CAAC,OAAO,EACf,OAAO,CAAC,OAAO,CAChB,CAAC;IAEF,OAAO,aAAa,CAAC;AACvB,CAAC","sourcesContent":["import { isSameYear, shiftDate } from 'ngx-bootstrap/chronos';\r\nimport { YearsCalendarViewModel, CalendarCellViewModel } from '../models';\r\nimport { isYearDisabled } from '../utils/bs-calendar-utils';\r\n\r\nexport interface FlagYearsCalendarOptions {\r\n  isDisabled: boolean;\r\n  minDate: Date;\r\n  maxDate: Date;\r\n  hoveredYear: Date;\r\n  selectedDate: Date;\r\n  selectedRange: Date[];\r\n  displayMonths: number;\r\n  yearIndex: number;\r\n}\r\n\r\nexport function flagYearsCalendar(\r\n  yearsCalendar: YearsCalendarViewModel,\r\n  options: FlagYearsCalendarOptions\r\n): YearsCalendarViewModel {\r\n  yearsCalendar.years.forEach(\r\n    (years: CalendarCellViewModel[], rowIndex: number) => {\r\n      years.forEach((year: CalendarCellViewModel, yearIndex: number) => {\r\n        let isSelected: boolean;\r\n        const isHovered = isSameYear(year.date, options.hoveredYear);\r\n        const isDisabled =\r\n          options.isDisabled ||\r\n          isYearDisabled(year.date, options.minDate, options.maxDate);\r\n\r\n        if (!options.selectedDate && options.selectedRange) {\r\n          isSelected = isSameYear(year.date, options.selectedRange[0]);\r\n          if (!isSelected) {\r\n            isSelected = isSameYear(year.date, options.selectedRange[1]);\r\n          }\r\n        } else {\r\n          isSelected = isSameYear(year.date, options.selectedDate);\r\n        }\r\n\r\n        const newMonth = Object.assign(/*{},*/ year, { isHovered, isDisabled, isSelected });\r\n        if (\r\n          year.isHovered !== newMonth.isHovered ||\r\n          year.isDisabled !== newMonth.isDisabled ||\r\n          year.isSelected !== newMonth.isSelected\r\n        ) {\r\n          yearsCalendar.years[rowIndex][yearIndex] = newMonth;\r\n        }\r\n      });\r\n    }\r\n  );\r\n\r\n  // todo: add check for linked calendars\r\n  yearsCalendar.hideLeftArrow =\r\n    options.yearIndex > 0 && options.yearIndex !== options.displayMonths;\r\n  yearsCalendar.hideRightArrow =\r\n    options.yearIndex < options.displayMonths &&\r\n    options.yearIndex + 1 !== options.displayMonths;\r\n\r\n  yearsCalendar.disableLeftArrow = isYearDisabled(\r\n    shiftDate(yearsCalendar.years[0][0].date, { year: -1 }),\r\n    options.minDate,\r\n    options.maxDate\r\n  );\r\n  const i = yearsCalendar.years.length - 1;\r\n  const j = yearsCalendar.years[i].length - 1;\r\n  yearsCalendar.disableRightArrow = isYearDisabled(\r\n    shiftDate(yearsCalendar.years[i][j].date, { year: 1 }),\r\n    options.minDate,\r\n    options.maxDate\r\n  );\r\n\r\n  return yearsCalendar;\r\n}\r\n"]}