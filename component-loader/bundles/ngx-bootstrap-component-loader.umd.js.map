{"version":3,"file":"ngx-bootstrap-component-loader.umd.js","sources":["../../../../src/component-loader/bs-component-ref.class.ts","../../../../src/component-loader/content-ref.class.ts","../../../../src/component-loader/component-loader.class.ts","../../../../src/component-loader/component-loader.factory.ts","../../../../src/component-loader/ngx-bootstrap-component-loader.ts"],"sourcesContent":["import { TemplateRef, ViewContainerRef } from '@angular/core';\r\n\r\nexport class BsComponentRef<T> {\r\n  templateRef: TemplateRef<T>;\r\n  viewContainer: ViewContainerRef;\r\n}\r\n","/**\r\n * @copyright Valor Software\r\n * @copyright Angular ng-bootstrap team\r\n */\r\n\r\nimport { ComponentRef, ViewRef } from '@angular/core';\r\n\r\nexport class ContentRef {\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  nodes: any[];\r\n  viewRef?: ViewRef;\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  componentRef?: ComponentRef<any>;\r\n\r\n  constructor(\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    nodes: any[],\r\n    viewRef?: ViewRef,\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    componentRef?: ComponentRef<any>\r\n  ) {\r\n    this.nodes = nodes;\r\n    this.viewRef = viewRef;\r\n    this.componentRef = componentRef;\r\n  }\r\n}\r\n","// todo: add delay support\r\n// todo: merge events onShow, onShown, etc...\r\n// todo: add global positioning configuration?\r\nimport {\r\n  ApplicationRef,\r\n  ComponentFactory,\r\n  ComponentFactoryResolver,\r\n  ComponentRef,\r\n  ElementRef,\r\n  EmbeddedViewRef,\r\n  EventEmitter,\r\n  Injector,\r\n  NgZone,\r\n  Renderer2,\r\n  StaticProvider,\r\n  TemplateRef,\r\n  Type,\r\n  ViewContainerRef\r\n} from '@angular/core';\r\n\r\nimport { PositioningOptions, PositioningService } from 'ngx-bootstrap/positioning';\r\n\r\nimport {\r\n  listenToTriggersV2,\r\n  registerEscClick,\r\n  registerOutsideClick\r\n} from 'ngx-bootstrap/utils';\r\n\r\nimport { ContentRef } from './content-ref.class';\r\nimport { ListenOptions } from './listen-options.model';\r\nimport { Subscription } from 'rxjs';\r\n\r\nexport class ComponentLoader<T> {\r\n  onBeforeShow: EventEmitter<void> = new EventEmitter();\r\n  onShown = new EventEmitter();\r\n  onBeforeHide = new EventEmitter();\r\n  onHidden = new EventEmitter();\r\n\r\n  instance: T;\r\n  _componentRef: ComponentRef<T>;\r\n  _inlineViewRef: EmbeddedViewRef<T>;\r\n\r\n  private _providers: StaticProvider[] = [];\r\n  private _componentFactory: ComponentFactory<T>;\r\n  private _zoneSubscription: Subscription;\r\n  private _contentRef: ContentRef;\r\n  private _innerComponent: ComponentRef<T>;\r\n\r\n  private _unregisterListenersFn: () => void;\r\n\r\n  get isShown(): boolean {\r\n    if (this._isHiding) {\r\n      return false;\r\n    }\r\n\r\n    return !!this._componentRef;\r\n  }\r\n\r\n  private _isHiding = false;\r\n\r\n  /**\r\n   * Placement of a component. Accepts: \"top\", \"bottom\", \"left\", \"right\"\r\n   */\r\n  private attachment: string;\r\n\r\n  /**\r\n   * A selector specifying the element the popover should be appended to.\r\n   */\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  private container: string | ElementRef | any;\r\n\r\n  /**\r\n   * A selector used if container element was not found\r\n   */\r\n  private containerDefaultSelector = 'body';\r\n\r\n  /**\r\n   * Specifies events that should trigger. Supports a space separated list of\r\n   * event names.\r\n   */\r\n  private triggers: string;\r\n\r\n  private _listenOpts: ListenOptions = {};\r\n  private _globalListener = Function.prototype;\r\n\r\n  /**\r\n   * Do not use this directly, it should be instanced via\r\n   * `ComponentLoadFactory.attach`\r\n   * @internal\r\n   */\r\n  public constructor(\r\n    private _viewContainerRef: ViewContainerRef,\r\n    private _renderer: Renderer2,\r\n    private _elementRef: ElementRef,\r\n    private _injector: Injector,\r\n    private _componentFactoryResolver: ComponentFactoryResolver,\r\n    private _ngZone: NgZone,\r\n    private _applicationRef: ApplicationRef,\r\n    private _posService: PositioningService\r\n  ) { }\r\n\r\n  attach(compType: Type<T>): ComponentLoader<T> {\r\n    this._componentFactory = this._componentFactoryResolver\r\n      .resolveComponentFactory<T>(compType);\r\n\r\n    return this;\r\n  }\r\n\r\n  // todo: add behaviour: to target element, `body`, custom element\r\n  to(container?: string | ElementRef): ComponentLoader<T> {\r\n    this.container = container || this.container;\r\n\r\n    return this;\r\n  }\r\n\r\n  position(opts?: PositioningOptions): ComponentLoader<T> {\r\n    this.attachment = opts.attachment || this.attachment;\r\n        this._elementRef = (opts.target as ElementRef) || this._elementRef;\r\n\r\n    return this;\r\n  }\r\n\r\n  provide(provider: StaticProvider): ComponentLoader<T> {\r\n    this._providers.push(provider);\r\n\r\n    return this;\r\n  }\r\n\r\n  // todo: appendChild to element or document.querySelector(this.container)\r\n\r\n  show(opts: {\r\n    content?: string | TemplateRef<unknown>;\r\n    context?: unknown;\r\n    initialState?: unknown;\r\n    [key: string]: unknown;\r\n    id?: number|string;\r\n  } = {}\r\n  ): ComponentRef<T> {\r\n\r\n    this._subscribePositioning();\r\n    this._innerComponent = null;\r\n\r\n    if (!this._componentRef) {\r\n      this.onBeforeShow.emit();\r\n      this._contentRef = this._getContentRef(opts.content, opts.context, opts.initialState);\r\n\r\n      const injector = Injector.create({\r\n        providers: this._providers,\r\n        parent: this._injector\r\n      });\r\n\r\n      this._componentRef = this._componentFactory.create(injector, this._contentRef.nodes);\r\n\r\n      this._applicationRef.attachView(this._componentRef.hostView);\r\n      // this._componentRef = this._viewContainerRef\r\n      //   .createComponent(this._componentFactory, 0, injector, this._contentRef.nodes);\r\n      this.instance = this._componentRef.instance;\r\n\r\n      Object.assign(this._componentRef.instance, opts);\r\n\r\n      if (this.container instanceof ElementRef) {\r\n        this.container.nativeElement.appendChild(\r\n          this._componentRef.location.nativeElement\r\n        );\r\n      }\r\n\r\n      if (typeof this.container === 'string' && typeof document !== 'undefined') {\r\n        const selectedElement = document.querySelector(this.container) ||\r\n                                document.querySelector(this.containerDefaultSelector);\r\n\r\n        selectedElement.appendChild(this._componentRef.location.nativeElement);\r\n      }\r\n\r\n      if (\r\n        !this.container &&\r\n        this._elementRef &&\r\n        this._elementRef.nativeElement.parentElement\r\n      ) {\r\n        this._elementRef.nativeElement.parentElement.appendChild(\r\n          this._componentRef.location.nativeElement\r\n        );\r\n      }\r\n\r\n      // we need to manually invoke change detection since events registered\r\n      // via\r\n      // Renderer::listen() are not picked up by change detection with the\r\n      // OnPush strategy\r\n      if (this._contentRef.componentRef) {\r\n        this._innerComponent = this._contentRef.componentRef.instance;\r\n        this._contentRef.componentRef.changeDetectorRef.markForCheck();\r\n        this._contentRef.componentRef.changeDetectorRef.detectChanges();\r\n      }\r\n      this._componentRef.changeDetectorRef.markForCheck();\r\n      this._componentRef.changeDetectorRef.detectChanges();\r\n\r\n\r\n      this.onShown.emit(opts.id ? { id: opts.id } : this._componentRef.instance);\r\n    }\r\n\r\n    this._registerOutsideClick();\r\n\r\n    return this._componentRef;\r\n  }\r\n\r\n  hide(id?: number|string): ComponentLoader<T> {\r\n    if (!this._componentRef) {\r\n      return this;\r\n    }\r\n\r\n    this._posService.deletePositionElement(this._componentRef.location);\r\n\r\n    this.onBeforeHide.emit(this._componentRef.instance);\r\n\r\n    const componentEl = this._componentRef.location.nativeElement;\r\n    componentEl.parentNode.removeChild(componentEl);\r\n    if (this._contentRef.componentRef) {\r\n      this._contentRef.componentRef.destroy();\r\n    }\r\n\r\n    if (this._viewContainerRef && this._contentRef.viewRef) {\r\n      this._viewContainerRef.remove(\r\n        this._viewContainerRef.indexOf(this._contentRef.viewRef)\r\n      );\r\n    }\r\n    if (this._contentRef.viewRef) {\r\n      this._contentRef.viewRef.destroy();\r\n    }\r\n\r\n    this._contentRef = null;\r\n    this._componentRef = null;\r\n    this._removeGlobalListener();\r\n\r\n    this.onHidden.emit(id ? { id } : null);\r\n\r\n    return this;\r\n  }\r\n\r\n  toggle(): void {\r\n    if (this.isShown) {\r\n      this.hide();\r\n\r\n      return;\r\n    }\r\n\r\n    this.show();\r\n  }\r\n\r\n  dispose(): void {\r\n    if (this.isShown) {\r\n      this.hide();\r\n    }\r\n\r\n    this._unsubscribePositioning();\r\n\r\n    if (this._unregisterListenersFn) {\r\n      this._unregisterListenersFn();\r\n    }\r\n  }\r\n\r\n  listen(listenOpts: ListenOptions): ComponentLoader<T> {\r\n    this.triggers = listenOpts.triggers || this.triggers;\r\n    this._listenOpts.outsideClick = listenOpts.outsideClick;\r\n    this._listenOpts.outsideEsc = listenOpts.outsideEsc;\r\n    listenOpts.target = listenOpts.target || this._elementRef.nativeElement;\r\n\r\n    const hide = (this._listenOpts.hide = () =>\r\n      listenOpts.hide ? listenOpts.hide() : void this.hide());\r\n    const show = (this._listenOpts.show = (registerHide) => {\r\n      listenOpts.show ? listenOpts.show(registerHide) : this.show(registerHide);\r\n      registerHide();\r\n    });\r\n\r\n    const toggle = (registerHide) => {\r\n      this.isShown ? hide() : show(registerHide);\r\n    };\r\n\r\n    this._unregisterListenersFn = listenToTriggersV2(this._renderer, {\r\n      target: listenOpts.target,\r\n      triggers: listenOpts.triggers,\r\n      show,\r\n      hide,\r\n      toggle\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  _removeGlobalListener() {\r\n    if (this._globalListener) {\r\n      this._globalListener();\r\n      this._globalListener = null;\r\n    }\r\n  }\r\n\r\n  attachInline(\r\n    vRef: ViewContainerRef,\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    template: TemplateRef<any>\r\n  ): ComponentLoader<T> {\r\n    this._inlineViewRef = vRef.createEmbeddedView(template);\r\n\r\n    return this;\r\n  }\r\n\r\n  _registerOutsideClick(): void {\r\n    if (!this._componentRef || !this._componentRef.location) {\r\n      return;\r\n    }\r\n    // why: should run after first event bubble\r\n    if (this._listenOpts.outsideClick) {\r\n      const target = this._componentRef.location.nativeElement;\r\n      setTimeout(() => {\r\n        this._globalListener = registerOutsideClick(this._renderer, {\r\n          targets: [target, this._elementRef.nativeElement],\r\n          outsideClick: this._listenOpts.outsideClick,\r\n          hide: () => this._listenOpts.hide()\r\n        });\r\n      });\r\n    }\r\n    if (this._listenOpts.outsideEsc) {\r\n      const target = this._componentRef.location.nativeElement;\r\n      this._globalListener = registerEscClick(this._renderer, {\r\n        targets: [target, this._elementRef.nativeElement],\r\n        outsideEsc: this._listenOpts.outsideEsc,\r\n        hide: () => this._listenOpts.hide()\r\n      });\r\n    }\r\n  }\r\n\r\n  getInnerComponent(): ComponentRef<T> {\r\n    return this._innerComponent;\r\n  }\r\n\r\n  private _subscribePositioning(): void {\r\n    if (this._zoneSubscription || !this.attachment) {\r\n      return;\r\n    }\r\n\r\n    this.onShown.subscribe(() => {\r\n      this._posService.position({\r\n        element: this._componentRef.location,\r\n        target: this._elementRef,\r\n        attachment: this.attachment,\r\n        appendToBody: this.container === 'body'\r\n      });\r\n    });\r\n\r\n    this._zoneSubscription = this._ngZone.onStable.subscribe(() => {\r\n      if (!this._componentRef) {\r\n        return;\r\n      }\r\n\r\n      this._posService.calcPosition();\r\n    });\r\n  }\r\n\r\n  private _unsubscribePositioning(): void {\r\n    if (!this._zoneSubscription) {\r\n      return;\r\n    }\r\n\r\n    this._zoneSubscription.unsubscribe();\r\n    this._zoneSubscription = null;\r\n  }\r\n\r\n  private _getContentRef(\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    content: string | TemplateRef<any> | any,\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    context?: any,\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    initialState?: any\r\n  ): ContentRef {\r\n    if (!content) {\r\n      return new ContentRef([]);\r\n    }\r\n\r\n    if (content instanceof TemplateRef) {\r\n      if (this._viewContainerRef) {\r\n        const _viewRef = this._viewContainerRef\r\n          .createEmbeddedView<TemplateRef<T>>(content, context);\r\n        _viewRef.markForCheck();\r\n\r\n        return new ContentRef([_viewRef.rootNodes], _viewRef);\r\n      }\r\n      const viewRef = content.createEmbeddedView({});\r\n      this._applicationRef.attachView(viewRef);\r\n\r\n      return new ContentRef([viewRef.rootNodes], viewRef);\r\n    }\r\n\r\n    if (typeof content === 'function') {\r\n      const contentCmptFactory = this._componentFactoryResolver.resolveComponentFactory(\r\n        content\r\n      );\r\n\r\n      const modalContentInjector = Injector.create({\r\n        providers: this._providers,\r\n        parent: this._injector\r\n      });\r\n\r\n      const componentRef = contentCmptFactory.create(modalContentInjector);\r\n      Object.assign(componentRef.instance, initialState);\r\n      this._applicationRef.attachView(componentRef.hostView);\r\n\r\n      return new ContentRef(\r\n        [[componentRef.location.nativeElement]],\r\n        componentRef.hostView,\r\n        componentRef\r\n      );\r\n    }\r\n\r\n    return new ContentRef([[this._renderer.createText(`${content}`)]]);\r\n  }\r\n}\r\n","import {\r\n  ApplicationRef, ComponentFactoryResolver, ElementRef, Injectable, Injector,\r\n  NgZone, Renderer2, ViewContainerRef\r\n} from '@angular/core';\r\nimport { ComponentLoader } from './component-loader.class';\r\nimport { PositioningService } from 'ngx-bootstrap/positioning';\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport class ComponentLoaderFactory {\r\n  constructor(private _componentFactoryResolver: ComponentFactoryResolver,\r\n              private _ngZone: NgZone,\r\n              private _injector: Injector,\r\n              private _posService: PositioningService,\r\n              private _applicationRef: ApplicationRef) {}\r\n\r\n  /**\r\n   *\r\n   * @param _elementRef\r\n   * @param _viewContainerRef\r\n   * @param _renderer\r\n   */\r\n  createLoader<T>(_elementRef: ElementRef,\r\n                  _viewContainerRef: ViewContainerRef,\r\n                  _renderer: Renderer2): ComponentLoader<T> {\r\n    return new ComponentLoader<T>(\r\n      _viewContainerRef,\r\n      _renderer,\r\n      _elementRef,\r\n      this._injector,\r\n      this._componentFactoryResolver,\r\n      this._ngZone,\r\n      this._applicationRef,\r\n      this._posService\r\n    );\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["EventEmitter","Injector","ElementRef","listenToTriggersV2","registerOutsideClick","registerEscClick","TemplateRef","Injectable"],"mappings":"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"}