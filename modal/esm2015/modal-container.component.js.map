{"version":3,"file":"modal-container.component.js","sourceRoot":"","sources":["../../../../src/modal/modal-container.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n  Component,\r\n  ElementRef,\r\n  HostListener,\r\n  OnDestroy,\r\n  OnInit,\r\n  Renderer2\r\n} from '@angular/core';\r\nimport {\r\n  CLASS_NAME,\r\n  DISMISS_REASONS,\r\n  ModalOptions,\r\n  TRANSITION_DURATIONS\r\n} from './modal-options.class';\r\nimport { BsModalService } from './bs-modal.service';\r\nimport { isBs3 } from 'ngx-bootstrap/utils';\r\n\r\n@Component({\r\n  selector: 'modal-container',\r\n  template: `\r\n    <div [class]=\"'modal-dialog' + (config.class ? ' ' + config.class : '')\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <ng-content></ng-content>\r\n      </div>\r\n    </div>\r\n  `,\r\n  // eslint-disable-next-line @angular-eslint/no-host-metadata-property\r\n  host: {\r\n    class: 'modal',\r\n    role: 'dialog',\r\n    tabindex: '-1',\r\n    '[attr.aria-modal]': 'true',\r\n    '[attr.aria-labelledby]': 'config.ariaLabelledBy',\r\n    '[attr.aria-describedby]': 'config.ariaDescribedby'\r\n  }\r\n})\r\nexport class ModalContainerComponent implements OnInit, OnDestroy {\r\n  config: ModalOptions;\r\n  isShown = false;\r\n  level: number;\r\n  isAnimated: boolean;\r\n  bsModalService: BsModalService;\r\n  private isModalHiding = false;\r\n  private clickStartedInContent = false;\r\n\r\n  constructor(options: ModalOptions,\r\n              protected _element: ElementRef,\r\n              private _renderer: Renderer2) {\r\n    this.config = Object.assign({}, options);\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    if (this.isAnimated) {\r\n      this._renderer.addClass(\r\n        this._element.nativeElement,\r\n        CLASS_NAME.FADE\r\n      );\r\n    }\r\n    this._renderer.setStyle(\r\n      this._element.nativeElement,\r\n      'display',\r\n      'block'\r\n    );\r\n    setTimeout(() => {\r\n      this.isShown = true;\r\n      this._renderer.addClass(\r\n        this._element.nativeElement,\r\n        isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW\r\n      );\r\n    }, this.isAnimated ? TRANSITION_DURATIONS.BACKDROP : 0);\r\n    if (document && document.body) {\r\n      if (this.bsModalService.getModalsCount() === 1) {\r\n        this.bsModalService.checkScrollbar();\r\n        this.bsModalService.setScrollbar();\r\n      }\r\n      this._renderer.addClass(document.body, CLASS_NAME.OPEN);\r\n    }\r\n    if (this._element.nativeElement) {\r\n      this._element.nativeElement.focus();\r\n    }\r\n  }\r\n\r\n  @HostListener('mousedown', ['$event'])\r\n  onClickStarted(event: MouseEvent): void {\r\n    this.clickStartedInContent = event.target !== this._element.nativeElement;\r\n  }\r\n\r\n  @HostListener('click', ['$event'])\r\n  onClickStop(event: MouseEvent): void {\r\n    const clickedInBackdrop = event.target === this._element.nativeElement && !this.clickStartedInContent;\r\n    if (\r\n      this.config.ignoreBackdropClick ||\r\n      this.config.backdrop === 'static' ||\r\n      !clickedInBackdrop\r\n    ) {\r\n      this.clickStartedInContent = false;\r\n\r\n      return;\r\n    }\r\n    this.bsModalService.setDismissReason(DISMISS_REASONS.BACKRDOP);\r\n    this.hide();\r\n  }\r\n\r\n  @HostListener('window:popstate')\r\n  onPopState(): void {\r\n    this.bsModalService.setDismissReason(DISMISS_REASONS.BACK);\r\n    this.hide();\r\n  }\r\n\r\n  @HostListener('window:keydown.esc', ['$event'])\r\n  onEsc(event: KeyboardEvent): void {\r\n    if (!this.isShown) {\r\n      return;\r\n    }\r\n\r\n    if (event.keyCode === 27 || event.key === 'Escape') {\r\n      event.preventDefault();\r\n    }\r\n\r\n    if (\r\n      this.config.keyboard &&\r\n      this.level === this.bsModalService.getModalsCount()\r\n    ) {\r\n      this.bsModalService.setDismissReason(DISMISS_REASONS.ESC);\r\n      this.hide();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.isShown) {\r\n      this._hide();\r\n    }\r\n  }\r\n\r\n  hide(): void {\r\n    if (this.isModalHiding || !this.isShown) {\r\n      return;\r\n    }\r\n\r\n    if (this.config.closeInterceptor) {\r\n      this.config.closeInterceptor().then(\r\n        () => this._hide(),\r\n        () => undefined);\r\n\r\n      return;\r\n    }\r\n\r\n    this._hide();\r\n  }\r\n\r\n  private _hide(): void {\r\n    this.isModalHiding = true;\r\n    this._renderer.removeClass(\r\n      this._element.nativeElement,\r\n      isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW\r\n    );\r\n    setTimeout(() => {\r\n      this.isShown = false;\r\n      if (\r\n        document &&\r\n        document.body &&\r\n        this.bsModalService.getModalsCount() === 1\r\n      ) {\r\n        this._renderer.removeClass(document.body, CLASS_NAME.OPEN);\r\n      }\r\n      this.bsModalService.hide(this.config.id);\r\n      this.isModalHiding = false;\r\n    }, this.isAnimated ? TRANSITION_DURATIONS.MODAL : 0);\r\n  }\r\n}\r\n"]}