{"version":3,"file":"ngx-bootstrap-modal.js","sources":["../../../../src/modal/bs-modal-ref.service.ts","../../../../src/modal/modal-backdrop.options.ts","../../../../src/modal/modal-options.class.ts","../../../../src/modal/modal-container.component.ts","../../../../src/modal/modal-backdrop.component.ts","../../../../src/modal/modal.directive.ts","../../../../src/modal/bs-modal.service.ts","../../../../src/modal/modal.module.ts","../../../../src/modal/ngx-bootstrap-modal.ts"],"sourcesContent":["import { Injectable, EventEmitter } from '@angular/core';\r\n\r\n@Injectable()\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport class BsModalRef<T = any> {\r\n  /**\r\n   * Event that is fired when the modal behind the ref starts hiding\r\n   */\r\n  onHide: EventEmitter<unknown>;\r\n  /**\r\n   * Event that is fired when the modal behind the ref finishes hiding\r\n   */\r\n  onHidden: EventEmitter<unknown>;\r\n  /**\r\n   *  Allow user to ID for the modal. Otherwise, a unique number will be given\r\n   */\r\n  id: number;\r\n\r\n  /**\r\n   * Reference to a component inside the modal. Null if modal's been created with TemplateRef\r\n   */\r\n  content?: T | null;\r\n\r\n  /**\r\n   * Hides the modal\r\n   */\r\n  hide: () => void = () => void 0;\r\n  /**\r\n   * Sets new class to modal window\r\n   */\r\n  setClass: (newClass: string) => void = () => void 0;\r\n}\r\n","export class ModalBackdropOptions {\r\n  animate = true;\r\n\r\n  constructor(options: ModalBackdropOptions) {\r\n    Object.assign(this, options);\r\n  }\r\n}\r\n","import { Injectable, StaticProvider, InjectionToken } from '@angular/core';\r\nimport { ClassName, CloseInterceptorFn, DismissReasons, Selector, TransitionDurations } from './models';\r\n\r\n@Injectable()\r\nexport class ModalOptions<T = Record<string, unknown>> {\r\n  /**\r\n   *  Allow user to ID for the modal. Otherwise, a unique number will be given\r\n   */\r\n  id?: number;\r\n  /**\r\n   *  Includes a modal-backdrop element. Alternatively,\r\n   *  specify static for a backdrop which doesn't close the modal on click.\r\n   */\r\n  backdrop?: boolean | 'static';\r\n  /**\r\n   * Closes the modal when escape key is pressed.\r\n   */\r\n  keyboard?: boolean;\r\n\r\n  focus?: boolean;\r\n  /**\r\n   * Shows the modal when initialized.\r\n   */\r\n  show?: boolean;\r\n  /**\r\n   * Ignore the backdrop click\r\n   */\r\n  ignoreBackdropClick?: boolean;\r\n  /**\r\n   * Css class for opened modal\r\n   */\r\n  class?: string;\r\n  /**\r\n   * Toggle animation\r\n   */\r\n  animated?: boolean;\r\n  /**\r\n   * Modal data\r\n   */\r\n  initialState?: Partial<T>;\r\n  /**\r\n   * Function to intercept the closure\r\n   */\r\n  closeInterceptor?: CloseInterceptorFn;\r\n  /**\r\n   * Modal providers\r\n   */\r\n  providers?: StaticProvider[];\r\n  /**\r\n   * aria-labelledby attribute value to set on the modal window\r\n   */\r\n  ariaLabelledBy?: string;\r\n  /**\r\n   * aria-describedby attribute value to set on the modal window\r\n   */\r\n  ariaDescribedby?: string;\r\n}\r\n\r\nexport const modalConfigDefaults: ModalOptions = {\r\n  backdrop: true,\r\n  keyboard: true,\r\n  focus: true,\r\n  show: false,\r\n  ignoreBackdropClick: false,\r\n  class: '',\r\n  animated: true,\r\n  initialState: {},\r\n  closeInterceptor: null\r\n};\r\n\r\nexport const MODAL_CONFIG_DEFAULT_OVERRIDE: InjectionToken<ModalOptions> =\r\n  new InjectionToken<ModalOptions>('override-default-config');\r\n\r\nexport const CLASS_NAME: ClassName = {\r\n  SCROLLBAR_MEASURER: 'modal-scrollbar-measure',\r\n  BACKDROP: 'modal-backdrop',\r\n  OPEN: 'modal-open',\r\n  FADE: 'fade',\r\n  IN: 'in', // bs3\r\n  SHOW: 'show' // bs4\r\n};\r\n\r\nexport const SELECTOR: Selector = {\r\n  DIALOG: '.modal-dialog',\r\n  DATA_TOGGLE: '[data-toggle=\"modal\"]',\r\n  DATA_DISMISS: '[data-dismiss=\"modal\"]',\r\n  FIXED_CONTENT: '.navbar-fixed-top, .navbar-fixed-bottom, .is-fixed'\r\n};\r\n\r\nexport const TRANSITION_DURATIONS: TransitionDurations = {\r\n  MODAL: 300,\r\n  BACKDROP: 150\r\n};\r\n\r\nexport const DISMISS_REASONS: DismissReasons = {\r\n  BACKRDOP: 'backdrop-click',\r\n  ESC: 'esc',\r\n  BACK: 'browser-back-navigation-clicked'\r\n};\r\n","import {\r\n  Component,\r\n  ElementRef,\r\n  HostListener,\r\n  OnDestroy,\r\n  OnInit,\r\n  Renderer2\r\n} from '@angular/core';\r\nimport {\r\n  CLASS_NAME,\r\n  DISMISS_REASONS,\r\n  ModalOptions,\r\n  TRANSITION_DURATIONS\r\n} from './modal-options.class';\r\nimport { BsModalService } from './bs-modal.service';\r\nimport { isBs3 } from 'ngx-bootstrap/utils';\r\n\r\n@Component({\r\n  selector: 'modal-container',\r\n  template: `\r\n    <div [class]=\"'modal-dialog' + (config.class ? ' ' + config.class : '')\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <ng-content></ng-content>\r\n      </div>\r\n    </div>\r\n  `,\r\n  // eslint-disable-next-line @angular-eslint/no-host-metadata-property\r\n  host: {\r\n    class: 'modal',\r\n    role: 'dialog',\r\n    tabindex: '-1',\r\n    '[attr.aria-modal]': 'true',\r\n    '[attr.aria-labelledby]': 'config.ariaLabelledBy',\r\n    '[attr.aria-describedby]': 'config.ariaDescribedby'\r\n  }\r\n})\r\nexport class ModalContainerComponent implements OnInit, OnDestroy {\r\n  config: ModalOptions;\r\n  isShown = false;\r\n  level: number;\r\n  isAnimated: boolean;\r\n  bsModalService: BsModalService;\r\n  private isModalHiding = false;\r\n  private clickStartedInContent = false;\r\n\r\n  constructor(options: ModalOptions,\r\n              protected _element: ElementRef,\r\n              private _renderer: Renderer2) {\r\n    this.config = Object.assign({}, options);\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    if (this.isAnimated) {\r\n      this._renderer.addClass(\r\n        this._element.nativeElement,\r\n        CLASS_NAME.FADE\r\n      );\r\n    }\r\n    this._renderer.setStyle(\r\n      this._element.nativeElement,\r\n      'display',\r\n      'block'\r\n    );\r\n    setTimeout(() => {\r\n      this.isShown = true;\r\n      this._renderer.addClass(\r\n        this._element.nativeElement,\r\n        isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW\r\n      );\r\n    }, this.isAnimated ? TRANSITION_DURATIONS.BACKDROP : 0);\r\n    if (document && document.body) {\r\n      if (this.bsModalService.getModalsCount() === 1) {\r\n        this.bsModalService.checkScrollbar();\r\n        this.bsModalService.setScrollbar();\r\n      }\r\n      this._renderer.addClass(document.body, CLASS_NAME.OPEN);\r\n    }\r\n    if (this._element.nativeElement) {\r\n      this._element.nativeElement.focus();\r\n    }\r\n  }\r\n\r\n  @HostListener('mousedown', ['$event'])\r\n  onClickStarted(event: MouseEvent): void {\r\n    this.clickStartedInContent = event.target !== this._element.nativeElement;\r\n  }\r\n\r\n  @HostListener('click', ['$event'])\r\n  onClickStop(event: MouseEvent): void {\r\n    const clickedInBackdrop = event.target === this._element.nativeElement && !this.clickStartedInContent;\r\n    if (\r\n      this.config.ignoreBackdropClick ||\r\n      this.config.backdrop === 'static' ||\r\n      !clickedInBackdrop\r\n    ) {\r\n      this.clickStartedInContent = false;\r\n\r\n      return;\r\n    }\r\n    this.bsModalService.setDismissReason(DISMISS_REASONS.BACKRDOP);\r\n    this.hide();\r\n  }\r\n\r\n  @HostListener('window:popstate')\r\n  onPopState(): void {\r\n    this.bsModalService.setDismissReason(DISMISS_REASONS.BACK);\r\n    this.hide();\r\n  }\r\n\r\n  @HostListener('window:keydown.esc', ['$event'])\r\n  onEsc(event: KeyboardEvent): void {\r\n    if (!this.isShown) {\r\n      return;\r\n    }\r\n\r\n    if (event.keyCode === 27 || event.key === 'Escape') {\r\n      event.preventDefault();\r\n    }\r\n\r\n    if (\r\n      this.config.keyboard &&\r\n      this.level === this.bsModalService.getModalsCount()\r\n    ) {\r\n      this.bsModalService.setDismissReason(DISMISS_REASONS.ESC);\r\n      this.hide();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.isShown) {\r\n      this._hide();\r\n    }\r\n  }\r\n\r\n  hide(): void {\r\n    if (this.isModalHiding || !this.isShown) {\r\n      return;\r\n    }\r\n\r\n    if (this.config.closeInterceptor) {\r\n      this.config.closeInterceptor().then(\r\n        () => this._hide(),\r\n        () => undefined);\r\n\r\n      return;\r\n    }\r\n\r\n    this._hide();\r\n  }\r\n\r\n  private _hide(): void {\r\n    this.isModalHiding = true;\r\n    this._renderer.removeClass(\r\n      this._element.nativeElement,\r\n      isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW\r\n    );\r\n    setTimeout(() => {\r\n      this.isShown = false;\r\n      if (\r\n        document &&\r\n        document.body &&\r\n        this.bsModalService.getModalsCount() === 1\r\n      ) {\r\n        this._renderer.removeClass(document.body, CLASS_NAME.OPEN);\r\n      }\r\n      this.bsModalService.hide(this.config.id);\r\n      this.isModalHiding = false;\r\n    }, this.isAnimated ? TRANSITION_DURATIONS.MODAL : 0);\r\n  }\r\n}\r\n","import { Component, ElementRef, OnInit, Renderer2 } from '@angular/core';\r\n\r\nimport { CLASS_NAME } from './modal-options.class';\r\nimport { isBs3, Utils } from 'ngx-bootstrap/utils';\r\n\r\n\r\n/** This component will be added as background layout for modals if enabled */\r\n@Component({\r\n  selector: 'bs-modal-backdrop',\r\n  template: ' ',\r\n  // eslint-disable-next-line @angular-eslint/no-host-metadata-property\r\n  host: { class: CLASS_NAME.BACKDROP }\r\n})\r\nexport class ModalBackdropComponent implements OnInit {\r\n  get isAnimated(): boolean {\r\n    return this._isAnimated;\r\n  }\r\n\r\n  set isAnimated(value: boolean) {\r\n    this._isAnimated = value;\r\n    // this.renderer.setElementClass(this.element.nativeElement, `${ClassName.FADE}`, value);\r\n  }\r\n\r\n  get isShown(): boolean {\r\n    return this._isShown;\r\n  }\r\n\r\n  set isShown(value: boolean) {\r\n    this._isShown = value;\r\n    if (value) {\r\n      this.renderer.addClass(\r\n        this.element.nativeElement,\r\n        `${CLASS_NAME.IN}`\r\n      );\r\n    } else {\r\n      this.renderer.removeClass(\r\n        this.element.nativeElement,\r\n        `${CLASS_NAME.IN}`\r\n      );\r\n    }\r\n    if (!isBs3()) {\r\n      if (value) {\r\n        this.renderer.addClass(\r\n          this.element.nativeElement,\r\n          `${CLASS_NAME.SHOW}`\r\n        );\r\n      } else {\r\n        this.renderer.removeClass(\r\n          this.element.nativeElement,\r\n          `${CLASS_NAME.SHOW}`\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  element: ElementRef;\r\n  renderer: Renderer2;\r\n\r\n  protected _isAnimated: boolean;\r\n  protected _isShown = false;\r\n\r\n  constructor(element: ElementRef, renderer: Renderer2) {\r\n    this.element = element;\r\n    this.renderer = renderer;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    if (this.isAnimated) {\r\n      this.renderer.addClass(\r\n        this.element.nativeElement,\r\n        `${CLASS_NAME.FADE}`\r\n      );\r\n      Utils.reflow(this.element.nativeElement);\r\n    }\r\n    this.isShown = true;\r\n  }\r\n}\r\n","// todo: should we support enforce focus in?\r\n// todo: in original bs there are was a way to prevent modal from showing\r\n// todo: original modal had resize events\r\n\r\nimport {\r\n  ComponentRef, Directive, ElementRef, EventEmitter, HostListener, Input,\r\n  OnDestroy, OnInit, Output, Renderer2, ViewContainerRef, Optional, Inject\r\n} from '@angular/core';\r\n\r\nimport { document, window, isBs3, Utils } from 'ngx-bootstrap/utils';\r\nimport { ModalBackdropComponent } from './modal-backdrop.component';\r\nimport {\r\n  CLASS_NAME, DISMISS_REASONS, modalConfigDefaults, ModalOptions, MODAL_CONFIG_DEFAULT_OVERRIDE\r\n} from './modal-options.class';\r\nimport { ComponentLoader, ComponentLoaderFactory } from 'ngx-bootstrap/component-loader';\r\nimport { CloseInterceptorFn } from './models';\r\n\r\nconst TRANSITION_DURATION = 300;\r\nconst BACKDROP_TRANSITION_DURATION = 150;\r\n\r\n/** Mark any code with directive to show it's content in modal */\r\n@Directive({\r\n  selector: '[bsModal]',\r\n  exportAs: 'bs-modal'\r\n})\r\nexport class ModalDirective implements OnDestroy, OnInit {\r\n  /** allows to set modal configuration via element property */\r\n  @Input()\r\n  set config(conf: ModalOptions) {\r\n    this._config = this.getConfig(conf);\r\n  }\r\n\r\n  get config(): ModalOptions {\r\n    return this._config;\r\n  }\r\n\r\n  /** allows to provide a callback to intercept the closure of the modal */\r\n  @Input() closeInterceptor: CloseInterceptorFn;\r\n\r\n  /** This event fires immediately when the `show` instance method is called. */\r\n  @Output()\r\n  onShow: EventEmitter<ModalDirective> = new EventEmitter<ModalDirective>();\r\n  /** This event is fired when the modal has been made visible to the user\r\n   * (will wait for CSS transitions to complete)\r\n   */\r\n  @Output()\r\n  onShown: EventEmitter<ModalDirective> = new EventEmitter<ModalDirective>();\r\n  /** This event is fired immediately when\r\n   * the hide instance method has been called.\r\n   */\r\n  @Output()\r\n  onHide: EventEmitter<ModalDirective> = new EventEmitter<ModalDirective>();\r\n  /** This event is fired when the modal has finished being\r\n   * hidden from the user (will wait for CSS transitions to complete).\r\n   */\r\n  @Output()\r\n  onHidden: EventEmitter<ModalDirective> = new EventEmitter<ModalDirective>();\r\n\r\n  /** This field contains last dismiss reason.\r\n   * Possible values: `backdrop-click`, `esc` and `id: number`\r\n   * (if modal was closed by direct call of `.hide()`).\r\n   */\r\n  dismissReason: string;\r\n\r\n  get isShown(): boolean {\r\n    return this._isShown;\r\n  }\r\n\r\n  protected _config: ModalOptions;\r\n  protected _isShown = false;\r\n\r\n  protected isBodyOverflowing = false;\r\n  protected originalBodyPadding = 0;\r\n  protected scrollbarWidth = 0;\r\n\r\n  protected timerHideModal = 0;\r\n  protected timerRmBackDrop = 0;\r\n\r\n  // reference to backdrop component\r\n  protected backdrop: ComponentRef<ModalBackdropComponent>;\r\n  private _backdrop: ComponentLoader<ModalBackdropComponent>;\r\n\r\n  private isNested = false;\r\n  private clickStartedInContent = false;\r\n\r\n  constructor(\r\n    private _element: ElementRef,\r\n    _viewContainerRef: ViewContainerRef,\r\n    private _renderer: Renderer2,\r\n    clf: ComponentLoaderFactory,\r\n    @Optional() @Inject(MODAL_CONFIG_DEFAULT_OVERRIDE) modalDefaultOption: ModalOptions) {\r\n    this._backdrop = clf.createLoader<ModalBackdropComponent>(\r\n      _element,\r\n      _viewContainerRef,\r\n      _renderer\r\n    );\r\n    this._config = modalDefaultOption || modalConfigDefaults;\r\n  }\r\n\r\n  @HostListener('mousedown', ['$event'])\r\n  onClickStarted(event: MouseEvent): void {\r\n    this.clickStartedInContent = event.target !== this._element.nativeElement;\r\n  }\r\n\r\n  @HostListener('mouseup', ['$event'])\r\n  onClickStop(event: MouseEvent): void {\r\n    const clickedInBackdrop = event.target === this._element.nativeElement && !this.clickStartedInContent;\r\n    if (\r\n      this.config.ignoreBackdropClick ||\r\n      this.config.backdrop === 'static' ||\r\n      !clickedInBackdrop\r\n    ) {\r\n      this.clickStartedInContent = false;\r\n\r\n      return;\r\n    }\r\n    this.dismissReason = DISMISS_REASONS.BACKRDOP;\r\n    this.hide(event);\r\n  }\r\n\r\n  // todo: consider preventing default and stopping propagation\r\n  @HostListener('keydown.esc', ['$event'])\r\n  onEsc(event: KeyboardEvent): void {\r\n    if (!this._isShown) {\r\n      return;\r\n    }\r\n    if (event.keyCode === 27 || event.key === 'Escape') {\r\n      event.preventDefault();\r\n    }\r\n\r\n    if (this.config.keyboard) {\r\n      this.dismissReason = DISMISS_REASONS.ESC;\r\n      this.hide();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.config = void 0;\r\n    if (this._isShown) {\r\n      this._isShown = false;\r\n      this.hideModal();\r\n      this._backdrop.dispose();\r\n    }\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this._config = this._config || this.getConfig();\r\n    setTimeout(() => {\r\n      if (this._config.show) {\r\n        this.show();\r\n      }\r\n    }, 0);\r\n  }\r\n\r\n  /* Public methods */\r\n\r\n  /** Allows to manually toggle modal visibility */\r\n  toggle(): void {\r\n    return this._isShown ? this.hide() : this.show();\r\n  }\r\n\r\n  /** Allows to manually open modal */\r\n  show(): void {\r\n    this.dismissReason = null;\r\n    this.onShow.emit(this);\r\n    if (this._isShown) {\r\n      return;\r\n    }\r\n    clearTimeout(this.timerHideModal);\r\n    clearTimeout(this.timerRmBackDrop);\r\n\r\n    this._isShown = true;\r\n\r\n    this.checkScrollbar();\r\n    this.setScrollbar();\r\n\r\n    if (document && document.body) {\r\n      if (document.body.classList.contains(CLASS_NAME.OPEN)) {\r\n        this.isNested = true;\r\n      } else {\r\n        this._renderer.addClass(document.body, CLASS_NAME.OPEN);\r\n      }\r\n    }\r\n\r\n    this.showBackdrop(() => {\r\n      this.showElement();\r\n    });\r\n  }\r\n\r\n  /** Check if we can close the modal */\r\n  hide(event?: Event): void {\r\n    if (!this._isShown) {\r\n      return;\r\n    }\r\n\r\n    if (event) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    if (this.config.closeInterceptor) {\r\n      this.config.closeInterceptor().then(\r\n        () => this._hide(),\r\n        () => undefined);\r\n\r\n      return;\r\n    }\r\n\r\n    this._hide();\r\n  }\r\n\r\n  /** Private methods @internal */\r\n\r\n  /**\r\n   *  Manually close modal\r\n   *  @internal\r\n   */\r\n  protected _hide(): void {\r\n    this.onHide.emit(this);\r\n\r\n    window.clearTimeout(this.timerHideModal);\r\n    window.clearTimeout(this.timerRmBackDrop);\r\n\r\n    this._isShown = false;\r\n    this._renderer.removeClass(this._element.nativeElement, CLASS_NAME.IN);\r\n    if (!isBs3()) {\r\n      this._renderer.removeClass(this._element.nativeElement, CLASS_NAME.SHOW);\r\n    }\r\n    // this._addClassIn = false;\r\n\r\n    if (this._config.animated) {\r\n      this.timerHideModal = window.setTimeout(\r\n        () => this.hideModal(),\r\n        TRANSITION_DURATION\r\n      );\r\n    } else {\r\n      this.hideModal();\r\n    }\r\n  }\r\n\r\n  protected getConfig(config?: ModalOptions): ModalOptions {\r\n    return Object.assign({}, this._config, config);\r\n  }\r\n\r\n  /**\r\n   *  Show dialog\r\n   *  @internal\r\n   */\r\n  protected showElement(): void {\r\n    // todo: replace this with component loader usage\r\n    if (\r\n      !this._element.nativeElement.parentNode ||\r\n      this._element.nativeElement.parentNode.nodeType !== Node.ELEMENT_NODE\r\n    ) {\r\n      // don't move modals dom position\r\n      if (document && document.body) {\r\n        document.body.appendChild(this._element.nativeElement);\r\n      }\r\n    }\r\n\r\n    this._renderer.setAttribute(\r\n      this._element.nativeElement,\r\n      'aria-hidden',\r\n      'false'\r\n    );\r\n    this._renderer.setAttribute(\r\n      this._element.nativeElement,\r\n      'aria-modal',\r\n      'true'\r\n    );\r\n    this._renderer.setStyle(\r\n      this._element.nativeElement,\r\n      'display',\r\n      'block'\r\n    );\r\n    this._renderer.setProperty(\r\n      this._element.nativeElement,\r\n      'scrollTop',\r\n      0\r\n    );\r\n\r\n    if (this._config.animated) {\r\n      Utils.reflow(this._element.nativeElement);\r\n    }\r\n\r\n    // this._addClassIn = true;\r\n    this._renderer.addClass(this._element.nativeElement, CLASS_NAME.IN);\r\n    if (!isBs3()) {\r\n      this._renderer.addClass(this._element.nativeElement, CLASS_NAME.SHOW);\r\n    }\r\n\r\n    const transitionComplete = () => {\r\n      if (this._config.focus) {\r\n        this._element.nativeElement.focus();\r\n      }\r\n      this.onShown.emit(this);\r\n    };\r\n\r\n    if (this._config.animated) {\r\n      setTimeout(transitionComplete, TRANSITION_DURATION);\r\n    } else {\r\n      transitionComplete();\r\n    }\r\n  }\r\n\r\n  /** @internal */\r\n  protected hideModal(): void {\r\n    this._renderer.setAttribute(\r\n      this._element.nativeElement,\r\n      'aria-hidden',\r\n      'true'\r\n    );\r\n    this._renderer.setStyle(\r\n      this._element.nativeElement,\r\n      'display',\r\n      'none'\r\n    );\r\n    this.showBackdrop(() => {\r\n      if (!this.isNested) {\r\n        if (document && document.body) {\r\n          this._renderer.removeClass(document.body, CLASS_NAME.OPEN);\r\n        }\r\n        this.resetScrollbar();\r\n      }\r\n      this.resetAdjustments();\r\n      this.focusOtherModal();\r\n      this.onHidden.emit(this);\r\n    });\r\n  }\r\n\r\n  // todo: original show was calling a callback when done, but we can use\r\n  // promise\r\n  /** @internal */\r\n  protected showBackdrop(callback?: () => void): void {\r\n    if (\r\n      this._isShown &&\r\n      this.config.backdrop &&\r\n      (!this.backdrop || !this.backdrop.instance.isShown)\r\n    ) {\r\n      this.removeBackdrop();\r\n      this._backdrop\r\n        .attach(ModalBackdropComponent)\r\n        .to('body')\r\n        .show({ isAnimated: this._config.animated });\r\n      this.backdrop = this._backdrop._componentRef;\r\n\r\n      if (!callback) {\r\n        return;\r\n      }\r\n\r\n      if (!this._config.animated) {\r\n        callback();\r\n\r\n        return;\r\n      }\r\n\r\n      setTimeout(callback, BACKDROP_TRANSITION_DURATION);\r\n    } else if (!this._isShown && this.backdrop) {\r\n      this.backdrop.instance.isShown = false;\r\n\r\n      const callbackRemove = () => {\r\n        this.removeBackdrop();\r\n        if (callback) {\r\n          callback();\r\n        }\r\n      };\r\n\r\n      if (this.backdrop.instance.isAnimated) {\r\n        this.timerRmBackDrop = window.setTimeout(\r\n          callbackRemove,\r\n          BACKDROP_TRANSITION_DURATION\r\n        );\r\n      } else {\r\n        callbackRemove();\r\n      }\r\n    } else if (callback) {\r\n      callback();\r\n    }\r\n  }\r\n\r\n  /** @internal */\r\n  protected removeBackdrop(): void {\r\n    this._backdrop.hide();\r\n  }\r\n\r\n  /** Events tricks */\r\n\r\n  // no need for it\r\n  // protected setEscapeEvent():void {\r\n  //   if (this._isShown && this._config.keyboard) {\r\n  //     $(this._element).on(Event.KEYDOWN_DISMISS, (event) => {\r\n  //       if (event.which === 27) {\r\n  //         this.hide()\r\n  //       }\r\n  //     })\r\n  //\r\n  //   } else if (!this._isShown) {\r\n  //     $(this._element).off(Event.KEYDOWN_DISMISS)\r\n  //   }\r\n  // }\r\n\r\n  // protected setResizeEvent():void {\r\n  // console.log(this.renderer.listenGlobal('', Event.RESIZE));\r\n  // if (this._isShown) {\r\n  //   $(window).on(Event.RESIZE, $.proxy(this._handleUpdate, this))\r\n  // } else {\r\n  //   $(window).off(Event.RESIZE)\r\n  // }\r\n  // }\r\n\r\n  protected focusOtherModal() {\r\n    if (this._element.nativeElement.parentElement == null) {\r\n      return;\r\n    }\r\n    const otherOpenedModals = this._element.nativeElement.parentElement.querySelectorAll('.in[bsModal]');\r\n    if (!otherOpenedModals.length) {\r\n      return;\r\n    }\r\n    otherOpenedModals[otherOpenedModals.length - 1].focus();\r\n  }\r\n\r\n  /** @internal */\r\n  protected resetAdjustments(): void {\r\n    this._renderer.setStyle(\r\n      this._element.nativeElement,\r\n      'paddingLeft',\r\n      ''\r\n    );\r\n    this._renderer.setStyle(\r\n      this._element.nativeElement,\r\n      'paddingRight',\r\n      ''\r\n    );\r\n  }\r\n\r\n  /** Scroll bar tricks */\r\n  /** @internal */\r\n  protected checkScrollbar(): void {\r\n    this.isBodyOverflowing = document.body.clientWidth < window.innerWidth;\r\n    this.scrollbarWidth = this.getScrollbarWidth();\r\n  }\r\n\r\n  protected setScrollbar(): void {\r\n    if (!document) {\r\n      return;\r\n    }\r\n\r\n    this.originalBodyPadding = parseInt(\r\n      window\r\n        .getComputedStyle(document.body)\r\n        .getPropertyValue('padding-right') || 0,\r\n      10\r\n    );\r\n\r\n    if (this.isBodyOverflowing) {\r\n      document.body.style.paddingRight = `${this.originalBodyPadding +\r\n        this.scrollbarWidth}px`;\r\n    }\r\n  }\r\n\r\n  protected resetScrollbar(): void {\r\n    document.body.style.paddingRight = `${this.originalBodyPadding}px`;\r\n  }\r\n\r\n  // thx d.walsh\r\n  protected getScrollbarWidth(): number {\r\n    const scrollDiv = this._renderer.createElement('div');\r\n    this._renderer.addClass(scrollDiv, CLASS_NAME.SCROLLBAR_MEASURER);\r\n    this._renderer.appendChild(document.body, scrollDiv);\r\n    const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n    this._renderer.removeChild(document.body, scrollDiv);\r\n\r\n    return scrollbarWidth;\r\n  }\r\n}\r\n","import {\r\n  ComponentRef,\r\n  Injectable,\r\n  TemplateRef,\r\n  EventEmitter,\r\n  Renderer2,\r\n  RendererFactory2,\r\n  Inject,\r\n  Optional\r\n} from '@angular/core';\r\n\r\nimport { ComponentLoader, ComponentLoaderFactory } from 'ngx-bootstrap/component-loader';\r\nimport { ModalBackdropComponent } from './modal-backdrop.component';\r\nimport { ModalContainerComponent } from './modal-container.component';\r\nimport {\r\n  CLASS_NAME,\r\n  modalConfigDefaults,\r\n  ModalOptions,\r\n  TRANSITION_DURATIONS,\r\n  MODAL_CONFIG_DEFAULT_OVERRIDE\r\n} from './modal-options.class';\r\nimport { BsModalRef } from './bs-modal-ref.service';\r\n\r\n@Injectable()\r\nexport class BsModalService {\r\n  // constructor props\r\n  config: ModalOptions;\r\n\r\n  onShow = new EventEmitter();\r\n  onShown = new EventEmitter();\r\n  onHide = new EventEmitter();\r\n  onHidden = new EventEmitter();\r\n\r\n  protected isBodyOverflowing = false;\r\n  protected originalBodyPadding = 0;\r\n\r\n  protected scrollbarWidth = 0;\r\n\r\n  protected backdropRef: ComponentRef<ModalBackdropComponent>;\r\n  private _backdropLoader: ComponentLoader<ModalBackdropComponent>;\r\n  private modalsCount = 0;\r\n  private lastDismissReason = null;\r\n\r\n  private loaders: ComponentLoader<ModalContainerComponent>[] = [];\r\n\r\n  private _renderer: Renderer2;\r\n\r\n  constructor(\r\n    rendererFactory: RendererFactory2,\r\n    private clf: ComponentLoaderFactory,\r\n    @Optional() @Inject(MODAL_CONFIG_DEFAULT_OVERRIDE) private modalDefaultOption: ModalOptions) {\r\n    this._backdropLoader = this.clf.createLoader<ModalBackdropComponent>(\r\n      null,\r\n      null,\r\n      null\r\n    );\r\n    this._renderer = rendererFactory.createRenderer(null, null);\r\n    this.config = modalDefaultOption ?\r\n      (Object.assign({}, modalConfigDefaults, modalDefaultOption)) :\r\n      modalConfigDefaults;\r\n  }\r\n\r\n  /** Shows a modal */\r\n  show<T>(\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    content: string | TemplateRef<any> | { new(...args: any[]): T },\r\n    config?: ModalOptions<T>\r\n  ): BsModalRef<T> {\r\n    this.modalsCount++;\r\n    this._createLoaders();\r\n\r\n    // must be different per every show() call\r\n    const id = config?.id || (new Date()).getUTCMilliseconds();\r\n    this.config = this.modalDefaultOption ?\r\n      Object.assign({}, modalConfigDefaults, this.modalDefaultOption, config) :\r\n      Object.assign({}, modalConfigDefaults, config);\r\n    this.config.id = id;\r\n\r\n    this._showBackdrop();\r\n    this.lastDismissReason = null;\r\n\r\n    return this._showModal<T>(content);\r\n  }\r\n\r\n  hide(id?: number) {\r\n    if (this.modalsCount === 1 || id == null) {\r\n      this._hideBackdrop();\r\n      this.resetScrollbar();\r\n    }\r\n    this.modalsCount = this.modalsCount >= 1 && id != null ? this.modalsCount - 1 : 0;\r\n    setTimeout(() => {\r\n      this._hideModal(id);\r\n      this.removeLoaders(id);\r\n    }, this.config.animated ? TRANSITION_DURATIONS.BACKDROP : 0);\r\n  }\r\n\r\n  _showBackdrop(): void {\r\n    const isBackdropEnabled =\r\n      this.config.backdrop || this.config.backdrop === 'static';\r\n    const isBackdropInDOM =\r\n      !this.backdropRef || !this.backdropRef.instance.isShown;\r\n\r\n    if (this.modalsCount === 1) {\r\n      this.removeBackdrop();\r\n\r\n      if (isBackdropEnabled && isBackdropInDOM) {\r\n        this._backdropLoader\r\n          .attach(ModalBackdropComponent)\r\n          .to('body')\r\n          .show({ isAnimated: this.config.animated });\r\n        this.backdropRef = this._backdropLoader._componentRef;\r\n      }\r\n    }\r\n  }\r\n\r\n  _hideBackdrop(): void {\r\n    if (!this.backdropRef) {\r\n      return;\r\n    }\r\n    this.backdropRef.instance.isShown = false;\r\n    const duration = this.config.animated ? TRANSITION_DURATIONS.BACKDROP : 0;\r\n    setTimeout(() => this.removeBackdrop(), duration);\r\n  }\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  _showModal<T>(content: any): BsModalRef<T> {\r\n    const modalLoader = this.loaders[this.loaders.length - 1];\r\n    if (this.config && this.config.providers) {\r\n      for (const provider of this.config.providers) {\r\n        modalLoader.provide(provider);\r\n      }\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const bsModalRef = new BsModalRef<any>();\r\n    const modalContainerRef = modalLoader\r\n      .provide({ provide: ModalOptions, useValue: this.config })\r\n      .provide({ provide: BsModalRef, useValue: bsModalRef })\r\n      .attach(ModalContainerComponent)\r\n      .to('body');\r\n    bsModalRef.hide = () => modalContainerRef.instance.hide();\r\n    bsModalRef.setClass = (newClass: string) => {\r\n      modalContainerRef.instance.config.class = newClass;\r\n    };\r\n\r\n    bsModalRef.onHidden = new EventEmitter<unknown>();\r\n    bsModalRef.onHide = new EventEmitter<unknown>();\r\n\r\n    this.copyEvent(modalLoader.onBeforeHide, bsModalRef.onHide);\r\n    this.copyEvent(modalLoader.onHidden, bsModalRef.onHidden);\r\n    // call 'show' method after assign setClass in bsModalRef.\r\n    // it makes modal component's bsModalRef available to call setClass method\r\n    modalContainerRef.show({\r\n      content,\r\n      isAnimated: this.config.animated,\r\n      initialState: this.config.initialState,\r\n      bsModalService: this,\r\n      id: this.config.id\r\n    });\r\n    modalContainerRef.instance.level = this.getModalsCount();\r\n\r\n    bsModalRef.content = modalLoader.getInnerComponent() || null;\r\n    bsModalRef.id = modalContainerRef.instance.config?.id;\r\n\r\n    return bsModalRef;\r\n  }\r\n\r\n  _hideModal(id?: number): void {\r\n    if (id != null) {\r\n      const indexToRemove = this.loaders.findIndex(loader => loader.instance.config.id === id);\r\n      const modalLoader = this.loaders[indexToRemove];\r\n      if (modalLoader) {\r\n        modalLoader.hide(id);\r\n      }\r\n    } else {\r\n      this.loaders.forEach(\r\n        (loader: ComponentLoader<ModalContainerComponent>) => {\r\n          loader.hide(loader.instance.config.id);\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  getModalsCount(): number {\r\n    return this.modalsCount;\r\n  }\r\n\r\n  setDismissReason(reason: string) {\r\n    this.lastDismissReason = reason;\r\n  }\r\n\r\n  removeBackdrop(): void {\r\n    this._renderer.removeClass(document.body, CLASS_NAME.OPEN);\r\n    this._backdropLoader.hide();\r\n    this.backdropRef = null;\r\n  }\r\n\r\n  /** Checks if the body is overflowing and sets scrollbar width */\r\n  /** @internal */\r\n  checkScrollbar(): void {\r\n    this.isBodyOverflowing = document.body.clientWidth < window.innerWidth;\r\n    this.scrollbarWidth = this.getScrollbarWidth();\r\n  }\r\n\r\n  setScrollbar(): void {\r\n    if (!document) {\r\n      return;\r\n    }\r\n\r\n    this.originalBodyPadding = parseInt(\r\n      window\r\n        .getComputedStyle(document.body)\r\n        .getPropertyValue('padding-right') || '0',\r\n      10\r\n    );\r\n\r\n    if (this.isBodyOverflowing) {\r\n      document.body.style.paddingRight = `${this.originalBodyPadding +\r\n        this.scrollbarWidth}px`;\r\n    }\r\n  }\r\n\r\n  private resetScrollbar(): void {\r\n    document.body.style.paddingRight = `${this.originalBodyPadding}px`;\r\n  }\r\n\r\n  // thx d.walsh\r\n  private getScrollbarWidth(): number {\r\n    const scrollDiv = this._renderer.createElement('div');\r\n    this._renderer.addClass(scrollDiv, CLASS_NAME.SCROLLBAR_MEASURER);\r\n    this._renderer.appendChild(document.body, scrollDiv);\r\n    const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n    this._renderer.removeChild(document.body, scrollDiv);\r\n\r\n    return scrollbarWidth;\r\n  }\r\n\r\n  private _createLoaders(): void {\r\n    const loader = this.clf.createLoader<ModalContainerComponent>(\r\n      null,\r\n      null,\r\n      null\r\n    );\r\n    this.copyEvent(loader.onBeforeShow, this.onShow);\r\n    this.copyEvent(loader.onShown, this.onShown);\r\n    this.copyEvent(loader.onBeforeHide, this.onHide);\r\n    this.copyEvent(loader.onHidden, this.onHidden);\r\n    this.loaders.push(loader);\r\n  }\r\n\r\n  private removeLoaders(id?: number): void {\r\n    if (id != null) {\r\n      const indexToRemove = this.loaders.findIndex(loader => loader.instance.config.id === id);\r\n      if (indexToRemove >= 0) {\r\n        this.loaders.splice(indexToRemove, 1);\r\n        this.loaders.forEach(\r\n          (loader: ComponentLoader<ModalContainerComponent>, i: number) => {\r\n            loader.instance.level = i + 1;\r\n          }\r\n        );\r\n      }\r\n    } else {\r\n      this.loaders.splice(0, this.loaders.length);\r\n    }\r\n  }\r\n\r\n  private copyEvent(from: EventEmitter<unknown>, to: EventEmitter<unknown>) {\r\n    from.subscribe((data) => {\r\n      to.emit(this.lastDismissReason || data);\r\n    });\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\n\r\nimport { ModalBackdropComponent } from './modal-backdrop.component';\r\nimport { ModalDirective } from './modal.directive';\r\nimport { PositioningService } from 'ngx-bootstrap/positioning';\r\nimport { ComponentLoaderFactory } from 'ngx-bootstrap/component-loader';\r\nimport { ModalContainerComponent } from './modal-container.component';\r\nimport { BsModalService } from './bs-modal.service';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ModalBackdropComponent,\r\n    ModalDirective,\r\n    ModalContainerComponent\r\n  ],\r\n  exports: [ModalBackdropComponent, ModalDirective],\r\n  entryComponents: [ModalBackdropComponent, ModalContainerComponent]\r\n})\r\nexport class ModalModule {\r\n  static forRoot(): ModuleWithProviders<ModalModule> {\r\n    return {\r\n      ngModule: ModalModule,\r\n      providers: [BsModalService, ComponentLoaderFactory, PositioningService]\r\n    };\r\n  }\r\n  static forChild(): ModuleWithProviders<ModalModule> {\r\n    return {\r\n      ngModule: ModalModule,\r\n      providers: [BsModalService, ComponentLoaderFactory, PositioningService]\r\n    };\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["i0.ɵɵelementStart","i0.ɵɵprojection","i0.ɵɵelementEnd","i0.ɵɵclassMap","document","window"],"mappings":"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"}