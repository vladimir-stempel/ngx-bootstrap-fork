{"version":3,"file":"humanize.js","sourceRoot":"","sources":["../../../../../src/chronos/duration/humanize.ts"],"names":[],"mappings":"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","sourcesContent":["import { createDuration } from './create';\r\nimport { Locale } from '../locale/locale.class';\r\nimport { Duration } from './constructor';\r\n\r\nlet round = Math.round;\r\nconst thresholds: { [key: string]: number } = {\r\n  ss: 44,         // a few seconds to seconds\r\n  s: 45,         // seconds to minute\r\n  m: 45,         // minutes to hour\r\n  h: 22,         // hours to day\r\n  d: 26,         // days to month\r\n  M: 11          // months to year\r\n};\r\n\r\n// helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize\r\nfunction substituteTimeAgo(str: 'future' | 'past', num: number,\r\n                           withoutSuffix: boolean, isFuture: boolean,\r\n                           locale: Locale): string {\r\n  return locale.relativeTime(num || 1, !!withoutSuffix, str, isFuture);\r\n}\r\n\r\nexport function relativeTime(posNegDuration: Duration, withoutSuffix: boolean, locale: Locale): string {\r\n  const duration = createDuration(posNegDuration).abs();\r\n  const seconds = round(duration.as('s'));\r\n  const minutes = round(duration.as('m'));\r\n  const hours = round(duration.as('h'));\r\n  const days = round(duration.as('d'));\r\n  const months = round(duration.as('M'));\r\n  const years = round(duration.as('y'));\r\n\r\n  const a: [string] | [string, number] =\r\n    seconds <= thresholds.ss && ['s', seconds] ||\r\n    seconds < thresholds.s && ['ss', seconds] ||\r\n    minutes <= 1 && ['m'] ||\r\n    minutes < thresholds.m && ['mm', minutes] ||\r\n    hours <= 1 && ['h'] ||\r\n    hours < thresholds.h && ['hh', hours] ||\r\n    days <= 1 && ['d'] ||\r\n    days < thresholds.d && ['dd', days] ||\r\n    months <= 1 && ['M'] ||\r\n    months < thresholds.M && ['MM', months] ||\r\n    years <= 1 && ['y'] || ['yy', years];\r\n\r\n  const b: [string, number | string, boolean, boolean, Locale] =\r\n    [a[0], a[1], withoutSuffix, +posNegDuration > 0, locale];\r\n  // a[2] = withoutSuffix;\r\n  // a[3] = +posNegDuration > 0;\r\n  // a[4] = locale;\r\n\r\n  return substituteTimeAgo.apply(null, b);\r\n}\r\n\r\n// This function allows you to set the rounding function for relative time strings\r\nexport function getSetRelativeTimeRounding(roundingFunction: any): boolean | ((x: number) => number) {\r\n  if (roundingFunction === undefined) {\r\n    return round;\r\n  }\r\n  if (typeof(roundingFunction) === 'function') {\r\n    round = roundingFunction;\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n// This function allows you to set a threshold for relative time strings\r\nexport function getSetRelativeTimeThreshold(threshold: string, limit: number): boolean | number {\r\n  if (thresholds[threshold] === undefined) {\r\n    return false;\r\n  }\r\n  if (limit === undefined) {\r\n    return thresholds[threshold];\r\n  }\r\n  thresholds[threshold] = limit;\r\n  if (threshold === 's') {\r\n    thresholds.ss = limit - 1;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n// export function humanize(withSuffix) {\r\n//   if (!this.isValid()) {\r\n//     return this.localeData().invalidDate();\r\n//   }\r\n//\r\n//   const locale = this.localeData();\r\n//   let output = relativeTime(this, !withSuffix, locale);\r\n//\r\n//   if (withSuffix) {\r\n//     output = locale.pastFuture(+this, output);\r\n//   }\r\n//\r\n//   return locale.postformat(output);\r\n// }\r\n"]}